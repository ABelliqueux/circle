RASPBERRY PI 5

This file gives information about the Raspberry Pi 5 support in Circle.


FEATURES

Currently is only a subset of features supported:

* System init and reboot
* MMU and cache support
* Memory allocation
* Property mailbox (subset of functions only)
* ActLED
* GIC interrupt controller (IRQ only)
* 6 UARTs (including IRQ support)
* Framebuffer and screen device
* 6 extended DMA channels (including IRQ support, port I/O untested)
* PCIe host bridge to RP1 device
* GPIO at RP1 (40-pin header, IO_BANK0-2)
* GPIO interrupts
* 2 xHCI USB controllers (4 ports)
* 4 I2C masters
* Multi-core support and spin locks
* CPU throttle and GPIO fan (gpiofanpin=45)
* Hardware random number generator
* Watchdog device
* Scheduler library
* Sound library (with USB sound only)
* Native FAT file-system library (in lib/fs/fat/)
* FatFs library (in addon/fatfs/)
* SD card library (in addon/SDCard/, EMMC driver only)
* LVGL graphics library (in addon/lvgl/)
* Bootloader (via UART connector)

The Cortex-A76 CPU of the Raspberry Pi 5 supports only AArch64 in the mode,
which is used by Circle (EL1), so AArch32 is and will not be supported.


BUILDING

The *Config.mk* for the Raspberry Pi 5 looks like this:

	AARCH = 64
	RASPPI = 5
	PREFIX64 = aarch64-none-elf-
	DEFINE += -DARM_ALLOW_MULTI_CORE	# optional

It can be created using:

	./configure -r 5 [ --multicore ]

Build all libraries using:

	./makeall [ -j ]

Go to the sample directory of your choice (see below) and enter:

	make


INSTALLING

The resulting kernel image file has the name kernel_2712.img. Additionally the
following files are required on the SD card:

* bcm2712-rpi-5-b.dtb (can be downloaded in boot/)
* config.txt (copy boot/config64.txt and rename it)


SAMPLES

Currently the following sample programs are operational:

* 01-gpiosimple (no audio clicks)
* 02-screenpixel
* 03-screentext
* 04-timer
* 05-usbsimple (with external USB 2.0 hub)
* 07-usbstorage
* 08-usbkeyboard
* 09-softserial (19200 Bps max.)
* 14-usbprinter
* 15-files
* 16-i2cping (master only)
* 17-fractal (multi-core supported)
* 19-tasks
* 24-hwrandom
* 26-cpustress
* 27-usbgamepad
* 32-i2cshell
* 34-sounddevices (USB sound only)
* 37-showgamepad
* 39-umsdplugging
* addon/display/sample/hd44780i2c
* addon/display/sample/ssd1306
* addon/FatFs/sample
* addon/lvgl/sample
* addon/OneWire/sample
* addon/SDCard/sample
* addon/sensor/sample/bmp180
* addon/sensor/sample/hcsr04
* addon/sensor/sample/ky040
* addon/sensor/sample/mpu6050

Additionally the following tests in test/ are operational:

* gpio
* gpio-interrupt
* screen-ansi-colors
* storage
* synchronization
* watchdog

USB

The USB 2 ports cannot be used to connect devices, which only support USB 3.
USB 1 and 2 devices can be used on any port. If you have problems with USB
devices (e.g. with some USB hubs), which are not detected at all, please add
the following option to the file cmdline.txt on the SD card:

	usbpowerdelay=1000
