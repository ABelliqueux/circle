RASPBERRY PI 5

This file gives information about the Raspberry Pi 5 support in Circle.


FEATURES

Currently is only a subset of features supported:

* System init and reboot
* MMU and cache support
* Memory allocation (with 3 GB high memory max. so far)
* Property mailbox (subset of functions only)
* ActLED
* GIC interrupt controller (IRQ only)
* 1 UART (via UART connector, including IRQ support)
* Framebuffer and screen device
* PCIe host bridge to RP1 device
* GPIO at RP1 (40-pin header, IO_BANK0-2)
* GPIO interrupts
* 2 xHCI USB controllers (4 ports)
* Multi-core support and spin locks
* Hardware random number generator
* Watchdog device
* Scheduler library
* Sound library (with USB sound only)
* Native FAT file-system library (in lib/fs/fat/)
* FatFs library (in addon/fatfs/)
* Bootloader (via UART connector)

Most external hardware interfaces (I2C etc.) are not supported yet.

The Cortex-A76 CPU of the Raspberry Pi 5 supports only AArch64 in the mode,
which is used by Circle (EL1), so AArch32 is and will not be supported.


BUILDING

The *Config.mk* for the Raspberry Pi 5 looks like this:

	AARCH = 64
	RASPPI = 5
	PREFIX64 = aarch64-none-elf-
	DEFINE += -DARM_ALLOW_MULTI_CORE	# optional

It can be created using:

	./configure -r 5 [ --multicore ]

Build all supported libraries using:

	./makeall5 [ -j ]

Go to the sample directory of your choice (see below) and enter:

	make


INSTALLING

The resulting kernel image file has the name kernel_2712.img. Additionally the
following files are required on the SD card:

* bcm2712-rpi-5-b.dtb (can be downloaded in boot/)
* config.txt (copy boot/config64.txt and rename it)


SAMPLES

Currently the following sample programs are operational:

* 01-gpiosimple (no audio clicks)
* 02-screenpixel
* 03-screentext
* 04-timer
* 05-usbsimple (with external USB 2.0 hub)
* 07-usbstorage
* 08-usbkeyboard
* 14-usbprinter
* 15-files
* 17-fractal (multi-core supported)
* 19-tasks
* 24-hwrandom
* 27-usbgamepad
* 34-sounddevices (USB sound only)
* 37-showgamepad
* 39-umsdplugging

Additionally the following tests in test/ are operational:

* gpio
* gpio-interrupt
* screen-ansi-colors
* synchronization
* watchdog

USB

The USB 2 ports cannot be used to connect devices, which only support USB 3.
USB 1 and 2 devices can be used on any port. If you have problems with USB
devices (e.g. with some USB hubs), which are not detected at all, please add
the following option to the file cmdline.txt on the SD card:

	usbpowerdelay=1000
